---
# Supporting organization
- name: Ensure organization ansibletestorg exists
  herve4m.quay.quay_organization:
    name: ansibletestorg
    email: ansibletestorg@example.com
    state: present
    quay_host: "{{ quay_url }}"
    quay_token: "{{ quay_token }}"
    validate_certs: false

# Supporting repository
- name: Ensure repository ansibletestrepo1 exists
  herve4m.quay.quay_repository:
    name: ansibletestorg/ansibletestrepo1
    state: present
    quay_host: "{{ quay_url }}"
    quay_token: "{{ quay_token }}"
    validate_certs: false

- name: Getting the details of the tags in the repository
  herve4m.quay.quay_tag_info:
    repository: ansibletestorg/ansibletestrepo1
    quay_host: "{{ quay_url }}"
    quay_token: "{{ quay_token }}"
    validate_certs: false
  register: tags

- debug:
    var: tags

- name: Ensure the repository is removed
  herve4m.quay.quay_repository:
    name: ansibletestorg/ansibletestrepo1
    state: absent
    quay_host: "{{ quay_url }}"
    quay_token: "{{ quay_token }}"
    validate_certs: false

- name: Ensure the organization is removed
  herve4m.quay.quay_organization:
    name: ansibletestorg
    state: absent
    quay_host: "{{ quay_url }}"
    quay_token: "{{ quay_token }}"
    validate_certs: false
...
